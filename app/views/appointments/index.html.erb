<div id="appointments_listing">
  <h2Appointments</h2>
  <div class="search">
    <% form_for(@search) do |f| %>
      <%= f.label :last_name_like %>
      <%= f.text_field :last_name_like, :size => 15 %>
      
      <%= f.label :county_like %>
      <%= f.text_field :county_like, :size => 15 %>
      
	  <% f.label :postal_code_like %>
      <% f.text_field :postal_code_like, :size => 10 %>
      
      <span class="separator">|</span>
      
      <%= f.check_box "pet_type_equals_any", {:name => "search[pet_type_equals_any][]"}, "cat" %>
	  <label>Cats</label>

      <%= f.check_box "pet_type_equals_any", {:name => "search[pet_type_equals_any][]"}, "dog" %>
      <label>Dogs</label>

      <span class="separator">|</span>
      
      <label>Dates</label>
      <%=f.text_field :created_at_after, :size => 11 %>

      <label>-</label>
      <%= f.text_field :created_at_before, :size => 11 %>

      <%= f.submit "Search" %>
	<% end %>
  </div>
  <div class="search_statistics">
    Search returned <strong><%= number_with_delimiter(@search.count) %></strong> results: 
    <strong><%= @search.count(:conditions => {:pet_type => 'cat'}) %></strong> cats and 
    <strong><%= @search.count(:conditions => {:pet_type => 'dog'}) %></strong> dogs.
  </div>
  <% if @appointments.blank? %>
    <h3 class="no_data">There are no appointments matching the criteria you've selected.</h3>
  <% else %>
    <%= will_paginate @appointments %>
    <% form_tag(print_appointments_path) do %>
      <%= submit_tag "Print Selected" %>
      <table>
        <thead>
          <tr>
            <th> &nbsp; </th>
            <th> ID </th>
            <th> Client Name </th>
            <th> Phone </th>
            <th> Pet Name </th>
            <th> Pet Type </th>
            <th> Pet Sex </th>
            <th> Vaccinated? </th>
            <th> Pregnant? </th>
            <th> &nbsp; </th>
          </thead>
        <tbody>
          <% @appointments.each do |appointment| %>
            <tr id="appointment_<% appointment.id %>">
              <td>
                <%= check_box_tag "ids[]", appointment.id, false, :id => "appointment_checkbox_#{appointment.id}", :class => "appointment_check_box" %>
              </td>
              <td>
                <%= appointment.id %>
              </td>
              <td>
                <%= appointment.client_name_last_comma_first %>
              </td>
              <td>
                <%= formatted_phone(appointment.phone) %>
                <br />
                <%= formatted_phone(appointment.alternate_phone) %>
              </td>
              <td>
                <%= appointment.pet_name %>
              </td>
              <td>
                <%= appointment.pet_type.capitalize %>
              </td>
              <td>
                <%= appointment.gender.humanize %>
              </td>
              <td>
                <%= appointment.pet_vaccinated.to_s.humanize %>
              </td>
              <td>
                <%= appointment.pet_pregnant.to_s.humanize %>
              </td>
              <td>
                <%= link_to 'Show', appointment %>
              </td>
            </tr>
          <% end %>
          <tr class="last">
            <td colspan="2">
              <%= submit_tag "Print Selected", :id => "print_submit" %>
            </td>
            <td colspan="8">&nbsp;</td>
          </tr>
        </tbody>
      </table>
    <% end %>
    <%= will_paginate @appointments %>
  </div>
</div>
